<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; background: #020205; overflow: hidden; touch-action: none; font-family: 'Courier New', monospace; }
        #gui { position: absolute; top: 10px; left: 10px; color: #0ff; text-shadow: 2px 2px #000; pointer-events: none; }
        .ctrl { position: absolute; background: rgba(0, 255, 255, 0.1); border: 1px solid #0ff; border-radius: 5px; color: #0ff; font-weight: bold; display: flex; align-items: center; justify-content: center; user-select: none; }
    </style>
</head>
<body>

<div id="gui">SCORE: <span id="score">0</span> | ENERGY: <span id="energy">100</span>%</div>

<div id="joy" class="ctrl" style="bottom: 20px; left: 20px; width: 120px; height: 120px; border-radius: 50%;">MOVE</div>
<div id="beam-btn" class="ctrl" style="bottom: 20px; right: 20px; width: 100px; height: 100px;">BEAM</div>

<script>
// --- AUDIO SYNTHESIZER (No external files needed) ---
const AudioEngine = {
    ctx: new (window.AudioContext || window.webkitAudioContext)(),
    playHum() {
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(40, this.ctx.currentTime);
        gain.gain.setValueAtTime(0.05, this.ctx.currentTime);
        osc.connect(gain); gain.connect(this.ctx.destination);
        osc.start();
    },
    playAbduct() {
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.frequency.setValueAtTime(200, this.ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(800, this.ctx.currentTime + 0.2);
        gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.2);
        osc.connect(gain); gain.connect(this.ctx.destination);
        osc.start(); osc.stop(this.ctx.currentTime + 0.2);
    }
};

const config = {
    type: Phaser.AUTO,
    width: 800,
    height: 450,
    physics: { default: 'arcade', arcade: { gravity: { y: 0 } } },
    pixelArt: true,
    scene: { preload: preload, create: create, update: update }
};

const game = new Phaser.Game(config);
let player, beam, ground, clouds, cows, score = 0, isBeaming = false;

function preload() {
    // 16-BIT ASSET GENERATION (Using Canvas to create textures)
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');

    // Mechanical UFO (16-bit style)
    canvas.width = 64; canvas.height = 32;
    ctx.fillStyle = '#444'; ctx.fillRect(12, 12, 40, 10); // Hull
    ctx.fillStyle = '#666'; ctx.fillRect(16, 8, 32, 4);   // Rim
    ctx.fillStyle = '#0ff'; ctx.globalAlpha = 0.6; ctx.arc(32, 10, 8, 0, Math.PI, true); ctx.fill(); // Dome
    ctx.globalAlpha = 1.0; ctx.fillStyle = '#f0f'; ctx.fillRect(20, 18, 4, 4); ctx.fillRect(40, 18, 4, 4); // Vents
    this.textures.addCanvas('ufo_16bit', canvas);

    // Cow
    canvas.width = 32; canvas.height = 24;
    ctx.fillStyle = '#fff'; ctx.fillRect(4, 8, 20, 12); ctx.fillStyle = '#000'; ctx.fillRect(8, 10, 4, 4);
    this.textures.addCanvas('cow_pixel', canvas);
}

function create() {
    // Parallax Layers
    clouds = this.add.tileSprite(400, 100, 1600, 450, null).setAlpha(0.3); // Layer 1
    ground = this.add.tileSprite(400, 400, 1600, 100, null).setAlpha(0.8); // Layer 2 (Ground)

    // Player
    player = this.physics.add.sprite(150, 200, 'ufo_16bit').setScale(1.5);
    player.setCollideWorldBounds(true);

    // Beam
    beam = this.add.rectangle(0, 0, 40, 1000, 0x00ffcc, 0.2).setVisible(false);

    // Groups
    cows = this.physics.add.group();
    this.time.addEvent({ delay: 2000, callback: () => {
        let c = cows.create(900, 380, 'cow_pixel');
        c.setVelocityX(-150);
    }, loop: true });

    // Controls Logic
    this.cursors = this.input.keyboard.createCursorKeys();
    
    // Mobile Touch
    document.getElementById('beam-btn').addEventListener('touchstart', (e) => { 
        e.preventDefault(); isBeaming = true; 
        if (AudioEngine.ctx.state === 'suspended') AudioEngine.ctx.resume();
        AudioEngine.playAbduct();
    });
    document.getElementById('beam-btn').addEventListener('touchend', () => { isBeaming = false; });
}

function update() {
    // Side Scrolling Motion
    ground.tilePositionX += 2;
    clouds.tilePositionX += 0.5;

    // Movement
    if (this.cursors.left.isDown) player.setVelocityX(-200);
    else if (this.cursors.right.isDown) player.setVelocityX(200);
    else player.setVelocityX(0);

    if (this.cursors.up.isDown) player.setVelocityY(-200);
    else if (this.cursors.down.isDown) player.setVelocityY(200);
    else player.setVelocityY(0);

    // Beaming
    if (isBeaming || this.cursors.space.isDown) {
        beam.setVisible(true).setPosition(player.x, player.y + 500);
        cows.children.iterate(c => {
            if (c && Math.abs(c.x - player.x) < 20) {
                c.setVelocityY(-200);
                if (c.y < player.y + 20) {
                    c.destroy();
                    score += 10;
                    document.getElementById('score').innerText = score;
                    AudioEngine.playAbduct();
                }
            }
        });
    } else {
        beam.setVisible(false);
    }
}
</script>

</body>
</html>
